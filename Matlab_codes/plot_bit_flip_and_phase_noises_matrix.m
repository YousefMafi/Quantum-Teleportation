% clc
% clear
% close all


ta1 = linspace(0,pi,20);
pa1 = linspace(0,2*pi,20);
[ta,pa] = meshgrid(ta1,pa1);

F_bf_pn = cos(ta./2).^3.*cos(conj(ta)./2).*(exp(-2.*t.*k)./4 + 1./4) - sin(ta./2).^3.*sin(conj(ta)./2).*(exp(-2.*t.*k)./4 - 1./4);
F_bf_pn = F_bf_pn+(1-max(max(F_bf_pn)));

figure('Colormap',...
    [0 0 0.5625;0 0.0434782616794109 0.58152174949646;0 0.0869565233588219 0.60054349899292;0 0.130434781312943 0.619565188884735;0 0.173913046717644 0.638586938381195;0 0.217391297221184 0.657608687877655;0 0.260869562625885 0.676630437374115;0 0.304347813129425 0.695652186870575;0 0.347826093435287 0.714673936367035;0 0.391304343938828 0.73369562625885;0 0.434782594442368 0.75271737575531;0 0.47826087474823 0.77173912525177;0 0.52173912525177 0.79076087474823;0 0.56521737575531 0.80978262424469;0 0.60869562625885 0.82880437374115;0 0.652173936367035 0.847826063632965;0 0.695652186870575 0.866847813129425;0 0.739130437374115 0.885869562625885;0 0.782608687877655 0.904891312122345;0 0.826086938381195 0.923913061618805;0 0.869565188884735 0.942934811115265;0 0.91304349899292 0.96195650100708;0 0.95652174949646 0.98097825050354;0 1 1;0.0555555559694767 1 0.944444417953491;0.111111111938953 1 0.888888895511627;0.16666667163372 1 0.833333313465118;0.222222223877907 1 0.777777791023254;0.277777791023254 1 0.722222208976746;0.333333343267441 1 0.666666686534882;0.388888895511627 1 0.611111104488373;0.444444447755814 1 0.555555582046509;0.5 1 0.5;0.555555582046509 1 0.444444447755814;0.611111104488373 1 0.388888895511627;0.666666686534882 1 0.333333343267441;0.722222208976746 1 0.277777791023254;0.777777791023254 1 0.222222223877907;0.833333313465118 1 0.16666667163372;0.888888895511627 1 0.111111111938953;0.944444417953491 1 0.0555555559694767;1 1 0;1 0.954545438289642 0;1 0.909090936183929 0;1 0.863636374473572 0;1 0.818181812763214 0;1 0.772727251052856 0;1 0.727272748947144 0;1 0.681818187236786 0;1 0.636363625526428 0;1 0.590909063816071 0;1 0.545454561710358 0;1 0.5 0;1 0.454545468091965 0;1 0.409090906381607 0;1 0.363636374473572 0;1 0.318181812763214 0;1 0.272727280855179 0;1 0.227272734045982 0;1 0.181818187236786 0;1 0.136363640427589 0;1 0.0909090936183929 0;1 0.0454545468091965 0;1 0 0]);

surf(ta,pa,real(F_bf_pn))
axis([0 pi 0 2*pi 0.5 1])
% view(gca,[-33.5 44]);
view(gca,[142.5 44]);
set(gca,...
 'xlim',[0 pi()],...
 'xtick',0:pi()/2:pi(),...
 'xticklabel',{'0' 'p/2' 'p'},...
 'ylim',[0 2*pi()],...
 'ytick',0:pi()/2:2*pi(),...
 'yticklabel',{'0' 'p/2' 'p' '3p/2' '2p'},...
 'zlim',[0 1],...
 'fontname','symbol','fontsize',15);
colorbar('fontname','times')
xlabel('\theta','FontSize',17)
ylabel('\phi','FontSize',17)
zlabel('Fidelity','fontname','times','FontSize',15)
